(fn f([g[h &%]](f g h%))([g%[h & r]](cons%(if h(lazy-seq(f g(g% h)r))))))